<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mes Recettes</title>

<link href="https://fonts.googleapis.com/css2?family=Proxima+Nova:wght@400;600&display=swap" rel="stylesheet">

<style>
body {
  font-family: 'Proxima Nova', sans-serif;
  padding:10px;
  background:#e8f5e9;
  margin:0;
}
header {
  background:#4caf50;
  color:white;
  text-align:center;
  padding:1rem;
  font-size:1.5rem;
  font-weight:600;
  border-radius: 0 0 10px 10px;
}
main {
  padding:1rem;
}
.recipe {
  background:white;
  padding:10px;
  margin-bottom:10px;
  border-radius:10px;
  box-shadow:0 2px 5px rgba(0,0,0,0.1);
}
.category {
  font-size:12px;
  color:#388e3c;
  text-transform:uppercase;
  display:block;
  margin-bottom:5px;
  font-weight:600;
}
form input, form select, form button {
  width:100%;
  padding:10px;
  margin-bottom:10px;
  border-radius:5px;
  border:1px solid #c8e6c9;
  box-sizing:border-box;
}
form button {
  background:#66bb6a;
  color:white;
  border:none;
  cursor:pointer;
  font-weight:600;
}
form button:hover {
  background:#388e3c;
}
button {
  cursor:pointer;
  margin-right:5px;
  border-radius:5px;
  padding:5px 10px;
  font-weight:600;
  border:none;
}
button.edit {
  background:#a5d6a7;
  color:#1b5e20;
}
button.delete {
  background:#c8e6c9;
  color:#2e7d32;
}
.filter-group {
  margin-bottom:10px;
}
</style>
</head>

<body>

<header>Mes Recettes ðŸŒ¿</header>
<main>

<form id="recipeForm">
  <input type="text" id="title" placeholder="Nom de la recette" required />
  <input type="url" id="url" placeholder="Lien de la recette" required />
  <select id="category" required>
    <option value="">Choisir une catÃ©gorie</option>
    <option value="entree">EntrÃ©e</option>
    <option value="plat">Plat</option>
    <option value="dessert">Dessert</option>
  </select>

  <label style="display:block; margin-bottom:10px;">
    <input type="checkbox" id="vegan" /> ðŸŒ¿ VÃ©gÃ©tale
  </label>

  <button type="submit">Ajouter la recette</button>
</form>

<div class="filter-group">
  <label>Filtrer par catÃ©gorie :</label>
  <select id="filterCategory">
    <option value="all">Toutes</option>
    <option value="entree">EntrÃ©e</option>
    <option value="plat">Plat</option>
    <option value="dessert">Dessert</option>
  </select>

  <label style="display:block; margin-top:5px;">
    <input type="checkbox" id="filterVegan" /> Afficher seulement ðŸŒ¿ VÃ©gÃ©tales
  </label>
</div>

<div id="recipesContainer"></div>

<script>
const container = document.getElementById('recipesContainer');
const form = document.getElementById('recipeForm');
const filterSelect = document.getElementById('filterCategory');
const filterVeganCheckbox = document.getElementById('filterVegan');

// Chargement depuis localStorage uniquement
let recipes = JSON.parse(localStorage.getItem('recipes') || '[]');

// Afficher les recettes
function renderRecipes() {
  recipes.sort((a,b) => a.title.localeCompare(b.title));

  const selectedCategory = filterSelect.value;
  const onlyVegan = filterVeganCheckbox.checked;

  container.innerHTML = '';

  recipes.forEach((r, index) => {
    if(selectedCategory !== 'all' && r.category !== selectedCategory) return;
    if(onlyVegan && !r.vegan) return;

    const div = document.createElement('div');
    div.className = 'recipe';
    div.innerHTML = `
      <h2>${r.title} ${r.vegan ? 'ðŸŒ¿' : ''}</h2>
      <span class="category">${r.category}</span>
      <a href="${r.url}" target="_blank">Voir la recette</a>
      <div style="margin-top:5px;">
        <button class="edit" onclick="editRecipe(${index})">Modifier</button>
        <button class="delete" onclick="deleteRecipe(${index})">Supprimer</button>
      </div>
    `;
    container.appendChild(div);
  });
}

// Supprimer
function deleteRecipe(index) {
  if(confirm("Supprimer cette recette ?")) {
    recipes.splice(index, 1);
    localStorage.setItem('recipes', JSON.stringify(recipes));
    renderRecipes();
  }
}

// Modifier
function editRecipe(index) {
  const r = recipes[index];
  title.value = r.title;
  url.value = r.url;
  category.value = r.category;
  vegan.checked = r.vegan;

  form.querySelector('button').textContent = 'Mettre Ã  jour';

  form.onsubmit = e => {
    e.preventDefault();
    r.title = title.value;
    r.url = url.value;
    r.category = category.value;
    r.vegan = vegan.checked;

    localStorage.setItem('recipes', JSON.stringify(recipes));
    renderRecipes();
    form.reset();
    form.querySelector('button').textContent = 'Ajouter la recette';
    setupAddRecipeListener();
  };
}

// Ajouter
function setupAddRecipeListener() {
  form.onsubmit = e => {
    e.preventDefault();
    recipes.push({
      title: title.value,
      url: url.value,
      category: category.value,
      vegan: vegan.checked
    });
    localStorage.setItem('recipes', JSON.stringify(recipes));
    renderRecipes();
    form.reset();
  };
}

filterSelect.addEventListener('change', renderRecipes);
filterVeganCheckbox.addEventListener('change', renderRecipes);

setupAddRecipeListener();
renderRecipes();
</script>

</main>
</body>
</html>
